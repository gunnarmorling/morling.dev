<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>What&#39;s in a Good Error Message? - Gunnar Morling</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="What&#39;s in a Good Error Message?" />
<meta property="og:description" content="
Update Jan 13: This post is discussed on Reddit


As software developers, we&#8217;ve all come across those annoying, not-so-useful error messages when using some library or framework: &#34;Couldn&#8217;t parse config file&#34;, &#34;Lacking permission for this operation&#34;, etc.
Ok, ok, so something went wrong apparently; but what exactly? What config file? Which permissions? And what should you do about it?
Error messages lacking this kind of information quickly create a feeling of frustration and helplessness.


So what makes a good error message then?
To me, it boils down to three pieces of information which should be conveyed by an error message:




Context: What led to the error? What was the code trying to do when it failed?


The error itself: What exactly failed?


Mitigation: What needs to be done in order to overcome the error?


" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.morling.dev/blog/whats-in-a-good-error-message/" />
<meta property="article:published_time" content="2022-01-12T19:20:00+01:00" />
<meta property="article:modified_time" content="2022-01-12T19:20:00+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What&#39;s in a Good Error Message?"/>
<meta name="twitter:description" content="
Update Jan 13: This post is discussed on Reddit


As software developers, we&#8217;ve all come across those annoying, not-so-useful error messages when using some library or framework: &#34;Couldn&#8217;t parse config file&#34;, &#34;Lacking permission for this operation&#34;, etc.
Ok, ok, so something went wrong apparently; but what exactly? What config file? Which permissions? And what should you do about it?
Error messages lacking this kind of information quickly create a feeling of frustration and helplessness.


So what makes a good error message then?
To me, it boils down to three pieces of information which should be conveyed by an error message:




Context: What led to the error? What was the code trying to do when it failed?


The error itself: What exactly failed?


Mitigation: What needs to be done in order to overcome the error?


"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.morling.dev/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.morling.dev/css/main.css" />

	
	<link rel="stylesheet" type="text/css" href="https://www.morling.dev/css/base16.dark.css" />
	
	<link rel="stylesheet" type="text/css" href="https://www.morling.dev/css/morlingdev.css" />
	

	<script>
		const searchUrl = "https:\/\/search.gunnar-morling.workers.dev\/Prod\/";
		const apiKey = "ff90d45f4afad3bd914c";
	</script>

	<script src="https://www.morling.dev//js/main.js"></script>
	<script src="https://www.morling.dev//js/medium-zoom.min.js"></script>

	<noscript>
		<style type="text/css">
			.club { display:none; }
		</style>
	</noscript>
</head>

<body>
	<div class="container wrapper post">
		<div class="header desktop">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.morling.dev/">Gunnar Morling</a></h1>
			<div class="site-description"><h2>Random Musings on All Things Software Engineering</h2></div>

			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="/blog/index.xml" title="RSS FEED">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#rss"/>
								</svg>
							</a>
						</li><li>
							<a href="https://github.com/gunnarmorling" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/gunnarmorling" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/projects/">Projects</a>
						</li>
						
						<li>
							<a href="/conferences/">Conferences</a>
						</li>
						
						<li>
							<a href="/podcasts/">Podcasts</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				<div class="pull-right">
					<div class="club">
						<form id="myForm">
							<input type="text" id="inputSearch" name="q" placeholder="Search..." onfocus="warmUp(this)">
							<button type="submit" id="buttonSubmitSearch" style="line-height: normal;"><i id="iconSearch" class="fa fa-search"></i></button>
						</form>
					</div>
				</div>
			</nav>
		</div>
	</div>
</div>

<div class="header mobile">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.morling.dev/">Gunnar Morling</a></h1>
			<div class="site-description"><h2>Random Musings on All Things Software Engineering</h2></div>
		</div>
	</div>
	<div>
		<div>
			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="/blog/index.xml" title="RSS FEED">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#rss"/>
								</svg>
							</a>
						</li><li>
							<a href="https://github.com/gunnarmorling" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/gunnarmorling" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/projects/">Projects</a>
						</li>
						
						<li>
							<a href="/conferences/">Conferences</a>
						</li>
						
						<li>
							<a href="/podcasts/">Podcasts</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				<div class="pull-right">
					<div class="club">
						<form id="myFormMobile">
							<input type="text" id="inputSearchMobile" name="q" placeholder="Search..." onfocus="warmUp(this)">
							<button type="submit" id="buttonSubmitSearchMobile" style="line-height: normal;"><i id="iconSearchMobile" class="fa fa-search"></i></button>
						</form>
					</div>
				</div>
			</nav>
		</div>
	</div>
</div>

<script type="text/javascript">
	window.addEventListener( "load", function () {
		const urlParams = new URLSearchParams(window.location.search);

		


		const form = document.getElementById( "myForm" );

		form.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(form));
		});

		const formMobile = document.getElementById( "myFormMobile" );

		formMobile.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(formMobile));
		});
	});
</script>


		<div id = "main-content">
			<div class="post-header">
				<h1 class="title">What&#39;s in a Good Error Message?</h1>
				<div class="meta">Posted at Jan 12, 2022</div>
			</div>

			<div class="markdown">
				<div class="paragraph">
<p><em>Update Jan 13: This post is <a href="https://www.reddit.com/r/programming/comments/s2kcp7/whats_in_a_good_error_message/">discussed on Reddit</a></em></p>
</div>
<div class="paragraph">
<p>As software developers, we&#8217;ve all come across those annoying, not-so-useful error messages when using some library or framework: <em>"Couldn&#8217;t parse config file"</em>, <em>"Lacking permission for this operation"</em>, etc.
Ok, ok, so <em>something</em> went wrong apparently; but what exactly? What config file? Which permissions? And what should you do about it?
Error messages lacking this kind of information quickly create a feeling of frustration and helplessness.</p>
</div>
<div class="paragraph">
<p>So what makes a good error message then?
To me, it boils down to three pieces of information which should be conveyed by an error message:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Context:</em> What led to the error? What was the code trying to do when it failed?</p>
</li>
<li>
<p><em>The error itself:</em> What exactly failed?</p>
</li>
<li>
<p><em>Mitigation:</em> What needs to be done in order to overcome the error?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s dive into these individidual aspects a bit.
Before we start, let me clarify that this is about error messages created by library or framework code,
for instance in form of an exception message, or in form of a message written to some log file.
This means the consumers of these error messages will typically be either other software developers
(encountering errors raised by 3rd party dependencies during application development),
or ops folks (encountering errors while running an application).</p>
</div>
<div class="paragraph">
<p>That&#8217;s in contrast to user-facing error messages,
for which other guidance and rules (in particular in regards to security concerns) should be applied.
For instance, you typically should not expose any implementation details in a user-facing message,
whereas that&#8217;s not that much of a concern&#8201;&#8212;&#8201;or on the contrary, it can even be desirable&#8201;&#8212;&#8201;for the kind of error messages discussed here.</p>
</div>
<div class="sect1">
<h2 id="_context">Context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a way, an error message tells a story; and as with every good story,
you need to establish some context about its general settings.
For an error message, this should tell the recipient what the code in question was trying to do when it failed.
In that light, the first example above, <em>"Couldn&#8217;t parse config file"</em>,
is addressing this aspect (and only this one) to some degree,
but probably it&#8217;s not enough.
For instance, it would be very useful to know the exact name of the file:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t parse config file: /etc/sample-config.properties"</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Using an example from <a href="https://debezium.io/">Debezium</a>,
the open-source change data capture platform I am working on in my day job,
the second message could read like so with some context about what happened:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Failed to create an initial snapshot of the data; lacking permission for this operation</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Coming back to error messages related to the processing of some input or configuration file,
it can be a good idea to print the absolute path.
In case file system resources are provided as relative paths,
this can help to identify wrong assumptions around the current working directory,
or whatever else is used as the root for resolving relative paths.
On the other hand, in particular in case of multi-tenant or SaaS scenarios,
you may consider filesystem layouts as a confidential implementation detail,
which you may prefer to not reveal to unknown code you run.
What&#8217;s best here depends on your specific situation.</p>
</div>
<div class="paragraph">
<p>If some framework supports different kinds of files,
the specific kind of the problematic file in question should be part of the message as well: <em>"Couldn&#8217;t parse entity mapping file&#8230;&#8203;"</em>.
If the error is about specific parts of the contents of a file,
displaying the line number and/or the line itself is a good idea.</p>
</div>
<div class="paragraph">
<p>In terms of <em>how</em> to convey the context of an error,
it can be part of messages themselves,
as shown above.
Many logging frameworks also support the notion of a <a href="https://www.baeldung.com/mdc-in-log4j-2-logback">Mapped Diagnostic Context</a> (MDC),
a map for propagating arbitrary key/value pairs into log messages.
So if your messages are meant to show up in logs, setting contextual information to the MDC can be very useful.
In Debezium this is used for instance to propagate the name of the affected connector,
allowing Kafka Connect users to tell apart log messages originating from different connectors deployed to the same Connect cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As far as propagating contextual information via log messages is concerned (as opposed to, say, error messages printed by a CLI tool),
<a href="https://www.innoq.com/en/blog/structured-logging/">structured logging</a>, typically in form of JSON, simplifies any downstream processing.
By putting contextual information into separate attributes of a structured log entry,
consumers can easily filter messages, ingest only specific sub-sets of messages based on their contents, etc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In case of exceptions, the chain of exceptions leading to the root cause is an important contextual information, too.
So I&#8217;d recommend to always log the entire exception chain,
rather than catching exceptions and only logging some substitute message instead.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_error_itself">The Error Itself</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On to the next part then, the description of the actual error itself.
That&#8217;s where you should describe what exactly happened in a concise way.
Sticking to the examples above, the first message, including context and error description could read like so:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t parse config file: /etc/sample-config.properties; given snapshot mode 'nevr' isn&#8217;t valid</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>And for the second one:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Failed to create an initial snapshot of the data; database user 'snapper' is lacking the required permissions</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Other than that, there&#8217;s not too much to be said here;
try to be efficient: make messages as long as needed, and as short as possible.
One idea could be to work with different variants of messages for the same kind of error, a shorter and a longer one.
Which one is used could be controlled via log levels or some kind of "verbose" flag.
Java developers may find CÃ©dric Champeau&#8217;s <a href="https://github.com/melix/jdoctor">jdoctor</a> library useful for implementing this.
Personally, I haven&#8217;t used such an approach yet, but it may be worth the effort for specific situations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mitigation">Mitigation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Having established the context of the failure and what went wrong exactly,
the last&#8201;&#8212;&#8201;and oftentimes most interesting&#8201;&#8212;&#8201;part is a description of how the user can overcome the error.
What&#8217;s the action they need to take in order to avoid it?
This could be as simple as telling the user about the constraints and/or valid values in case of the config file example
(i.e. akin to test failure messages, which show both expected and actual values):</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t parse config file: /etc/sample-config.properties; given snapshot mode 'nevr' isn&#8217;t valid (must be one of 'initial', 'always', 'never')</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>In case of the permission issue, you may clarify which ones are needed:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t take database snapshot: database user 'snapper' is lacking the required permissions 'SELECT', 'REPLICATION'</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Alternatively, if longer mitigation strategies are required,
you may point to a (stable!) URL in your reference documention which provides the required information:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t take database snapshot: database user 'snapper' is lacking the required permissions. Please see <a href="https://example.com/knowledge-base/snapshot-permissions/" class="bare">https://example.com/knowledge-base/snapshot-permissions/</a> for the complete set of necessary permissions</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>If some configuration change is required (for instance database or IAM permissions), your users will love you even more if you share that information in "executable" form,
for instance as GRANT statements which they can simply copy,
or vendor-specific CLI invocations such as <code>aws iam attach-role-policy --policy-arn arn:aws:iam::aws:policy/SomePolicy --role-name SomeRole</code>.</p>
</div>
<div class="paragraph">
<p>Speaking of external resources referenced in error messages,
it&#8217;s a great idea to have unique error codes as part of your messages
(such as Oracle&#8217;s ORA codes, or the <a href="https://docs.wildfly.org/26/wildscribe/log-message-reference.html">error messages</a> produced by WildFly and its components).
Corresponding resources (either provided by yourself, or externally, for instance in answers on StackOverflow) will then be easy to find using your favourite search engine.
Bonus points for adding a reference to your own canonical resource right to the error message itself:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Couldn&#8217;t take database snapshot: database user 'snapper' is lacking the required permissions (DBZ-42). Please see <a href="https://dbz.codes/dbz-42/" class="bare">https://dbz.codes/dbz-42/</a> for the complete set of necessary permissions</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>(That&#8217;s a made-up example, we don&#8217;t make use of this approach in Debezium currently; but I probably should look into buying the dbz.codes domain ðŸ˜‰).</p>
</div>
<div class="paragraph">
<p>The key take-away is that you should not leave your users in the dark about what they need to do in order to address the error they ran into.
Nothing is more frustrating than essentially being told "You did it wrong!", without getting hinted at what&#8217;s the right thing to do instead.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_best_practices">General Best Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lastly, some practices in regards to error messages which I try to adhere to, and which I would generally recommend:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Uniform voice and style:</em> The specific style chosen doesn&#8217;t matter too much, but you should settle on either active vs. passive voice ("couldn&#8217;t parse config file" vs. "config file couldn&#8217;t be parsed"), apply consistent casing, either finish or not finishes messages with a dot, etc.; not a big thing, but it will make your messages a bit easier to deal with</p>
</li>
<li>
<p><em>One concept, one term</em>: Avoid referring to the same concept from your domain using different terms in different error messages; similarly, avoid using the same term for multiple things. Use the same terms as in other places, e.g. your API documentation, reference guides etc.; The more consisent and unambiguous you are, the better</p>
</li>
<li>
<p><em>Don&#8217;t localize error messages:</em> This one is not as clear cut, but I&#8217;d generally recommend to not translate error messages into other languages than English; Again, this all is not about user-facing error messages, but about messages geared towards software developers and ops folks, who generally should command reasonable English skills; depending on your audience and target market, translations to specific languages might make sense, in which case a common, unambiguous error code should definitely be part of messages, so as to facilitate searching for the error on the internet</p>
</li>
<li>
<p><em>Don&#8217;t make error messages an API contract:</em> In case consumers of your API should be able to react to different kinds of errors, they should not be required to parse any error messages in order to do so. Instead, raise an exception type which exposes a machine-processable error code, or raise specific exception types which can be caught separately by the caller</p>
</li>
<li>
<p><em>Be cautious about exposing sensitive data:</em> if your library is in the business of handling and processing sensitive user data, make sure to to not create any privacy concerns; for instance, "show actual vs. expected value" may not pose a problem for values provided by an application developer or administrator; but it can pose a problem if the actual value is GDPR protected user data</p>
</li>
<li>
<p><em>Either raise an exception OR log an error, but not both:</em> A given error should either be communicated by raising an exception or by logging an error. Otherwise, when doing both, as the exception will typically end up being logged via some kind of generic handler anyways, the user would see information about the same error in their logs twice, which only adds confusion</p>
</li>
<li>
<p><em>Fail early:</em> This one is not so much about how to express error messages, but when to raise them; in general, the earlier, the better; a message at application start-up beats one later at runtime; a message at build time beats one at start-up, etc. Quicker feedback makes for shorter turn-around times for fixes and also helps to provide the context of any failures</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With that all being said, what&#8217;s your take on the matter? Any best practices you would recommend? Do you have any examples for particularly well (or poorly) crafted messages? Let me know in the comments below!</p>
</div>
</div>
</div>
			</div>

			<div class="post-tags">
				
					
				
			</div>
		</div><div id="disqus_thread">
  <script src="https://giscus.app/client.js"
    data-repo="gunnarmorling/discussions.morling.dev"
    data-repo-id="R_kgDOGXzqNQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOGXzqNc4B_2Pq"
    data-mapping="title"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
</div>

<noscript>Please enable JavaScript, or join the <a href="https://github.com/gunnarmorling/discussions.morling.dev/discussions/">discussion on GitHub</a>.</noscript>
</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Â© 2021 Gunnar Morling |  Licensed Under <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons BY-SA 4.0</a></div>
	</nav>
</div>


<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	if (window.sessionStorage) {
		var GA_SESSION_STORAGE_KEY = 'ga:clientId';
		ga('create', 'UA-156032495-1', {
	    'storage': 'none',
	    'clientId': sessionStorage.getItem(GA_SESSION_STORAGE_KEY)
	   });
	   ga(function(tracker) {
	    sessionStorage.setItem(GA_SESSION_STORAGE_KEY, tracker.get('clientId'));
	   });
   }
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>
	mediumZoom(document.querySelectorAll('div.imageblock > div.content > img'))
</script>

</body>
</html>
