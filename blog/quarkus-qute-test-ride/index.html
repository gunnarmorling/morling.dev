<!DOCTYPE html>
<html>
<head>
	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-DD997656SV"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-DD997656SV');
	</script>

	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Quarkus Qute – A Test Ride - Gunnar Morling</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Quarkus Qute – A Test Ride" />
<meta property="og:description" content="
One of the long-awaited features in Quarkus was support for server-side templating:
until recently, Quarkus supported only client-side web frameworks which obtain there data by calling a REST API on the backend.
This has changed with Quarkus 1.1: it comes with a brand-new template engine named Qute,
which allows to build web applications using server-side templates.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.morling.dev/blog/quarkus-qute-test-ride/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2020-01-03T10:00:00+01:00" />
<meta property="article:modified_time" content="2020-01-03T10:00:00+01:00" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Quarkus Qute – A Test Ride"/>
<meta name="twitter:description" content="
One of the long-awaited features in Quarkus was support for server-side templating:
until recently, Quarkus supported only client-side web frameworks which obtain there data by calling a REST API on the backend.
This has changed with Quarkus 1.1: it comes with a brand-new template engine named Qute,
which allows to build web applications using server-side templates.
"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.morling.dev/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.morling.dev/css/main.css" />

	
	<link rel="stylesheet" type="text/css" href="https://www.morling.dev/css/base16.dark.css" />
	
	<link rel="stylesheet" type="text/css" href="https://www.morling.dev/css/morlingdev.css" />
	

	<script>
		const searchUrl = "https:\/\/search-morling-dev.onrender.com\/";
		const apiKey = "ff90d45f4afad3bd914c";
	</script>

	<script src="https://www.morling.dev//js/main.js"></script>
	<script src="https://www.morling.dev//js/medium-zoom.min.js"></script>

	<noscript>
		<style type="text/css">
			.club { display:none; }
		</style>
	</noscript>
</head>

<body>
	<div class="container wrapper post">
		<div class="header desktop">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.morling.dev/">Gunnar Morling</a></h1>
			<div class="site-description"><h2>Random Musings on All Things Software Engineering</h2></div>

			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="/blog/index.xml" title="RSS FEED">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#rss"/>
								</svg>
							</a>
						</li><li>
							<a href="https://github.com/gunnarmorling" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://bsky.app/profile/gunnarmorling.dev" title="Bluesky">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#cloud"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/gunnarmorling" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.linkedin.com/in/gunnar-morling/" title="LinkedIn">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#linkedin"/>
								</svg>
							</a>
						</li><li>
							<a href="https://mastodon.online/@gunnarmorling" title="Mastodon">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#message-square"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/projects/">Projects</a>
						</li>
						
						<li>
							<a href="/conferences/">Conferences</a>
						</li>
						
						<li>
							<a href="/podcasts/">Podcasts</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				<div class="pull-right">
					<div class="club">
						<form id="myForm">
							<input type="text" id="inputSearch" name="q" placeholder="Search..." onfocus="warmUp(this)">
							<button type="submit" id="buttonSubmitSearch" style="line-height: normal;"><i id="iconSearch" class="fa fa-search"></i></button>
						</form>
					</div>
				</div>
			</nav>
		</div>
	</div>
</div>

<div class="header mobile">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.morling.dev/">Gunnar Morling</a></h1>
			<div class="site-description"><h2>Random Musings on All Things Software Engineering</h2></div>
		</div>
	</div>
	<div>
		<div>
			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="/blog/index.xml" title="RSS FEED">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#rss"/>
								</svg>
							</a>
						</li><li>
							<a href="https://github.com/gunnarmorling" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://bsky.app/profile/gunnarmorling.dev" title="Bluesky">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#cloud"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/gunnarmorling" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.linkedin.com/in/gunnar-morling/" title="LinkedIn">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#linkedin"/>
								</svg>
							</a>
						</li><li>
							<a href="https://mastodon.online/@gunnarmorling" title="Mastodon">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#message-square"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/projects/">Projects</a>
						</li>
						
						<li>
							<a href="/conferences/">Conferences</a>
						</li>
						
						<li>
							<a href="/podcasts/">Podcasts</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				<div class="pull-right">
					<div class="club">
						<form id="myFormMobile">
							<input type="text" id="inputSearchMobile" name="q" placeholder="Search..." onfocus="warmUp(this)">
							<button type="submit" id="buttonSubmitSearchMobile" style="line-height: normal;"><i id="iconSearchMobile" class="fa fa-search"></i></button>
						</form>
					</div>
				</div>
			</nav>
		</div>
	</div>
</div>

<script type="text/javascript">
	window.addEventListener( "load", function () {
		const urlParams = new URLSearchParams(window.location.search);

		


		const form = document.getElementById( "myForm" );

		form.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(form));
		});

		const formMobile = document.getElementById( "myFormMobile" );

		formMobile.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(formMobile));
		});
	});
</script>


		<div id = "main-content">
			<div class="post-header">
				<h1 class="title">Quarkus Qute – A Test Ride</h1>
				<div class="meta">Posted at Jan 3, 2020</div>
			</div>

			<div class="markdown">
				<div class="paragraph">
<p>One of the long-awaited features in Quarkus was support for server-side templating:
until recently, Quarkus supported only client-side web frameworks which obtain there data by calling a REST API on the backend.
This has changed with <a href="https://quarkus.io/blog/quarkus-1-1-0-final-released/">Quarkus 1.1</a>: it comes with a brand-new template engine named <a href="https://quarkus.io/guides/qute">Qute</a>,
which allows to build web applications using server-side templates.</p>
</div>
<div class="paragraph">
<p>When looking at frameworks for building web applications, there’s two large categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>client-side solutions based on JavaScript such as <a href="https://reactjs.org/">React</a>, <a href="https://vuejs.org/">vue.js</a> or <a href="https://angular.io/">Angular</a></p>
</li>
<li>
<p>server-side frameworks such as <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html">Spring Web MVC</a>, <a href="https://jakarta.ee/specifications/faces/">JSF</a> or <a href="https://www.mvc-spec.org/">MVC 1.0</a> (in the Java world)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both have their indivdual strengths and weaknesses and it’d be not very wise to always prefer one over the other.
Instead, the choice should be based on specific requirements
(e.g. what kind of interactivity is needed)
and prerequisites (e.g. the skillset of the team building the application).</p>
</div>
<div class="paragraph">
<p>Being mostly experienced with Java, server-side solutions are appealing to me,
as they allow me to use the language I know and tooling (build tools, IDEs) I’m familiar and most productive with.
So when Qute was announced, it instantly caught my attention and I had to give it a test ride.
In this post I want to share some of the experiences I made.</p>
</div>
<div class="paragraph">
<p>Note this isn’t a comprehensive tutorial for building web apps with Qute,
instead, I’d like to discuss a few things that stuck out to me.
You can find a complete working example here on <a href="https://github.com/gunnarmorling/quarkus-qute">GitHub</a>.
It implements a basic CRUD application for managing personal todos,
persisted in a Postgres database.
Here’s a video that shows the demo in action:</p>
</div>
<div class="paragraph">

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube-nocookie.com/embed/B6VD5Oi0-2c" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

</div>
<div class="sect1">
<h2 id="_the_basics">The Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Qute engine is based on RESTEasy/JAX-RS.
As such, Qute web applications are implemented by defining resource types with methods answering to specific HTTP verbs and accept headers.
The only difference being, that HTML pages are returned instead of JSON as in your typical REST-ful data API.
The individual pages are created by processing template files.
Here’s a basic example for returning all the Todo records in our application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
</pre></td><td class="code"><pre><span class="nd">@Path</span><span class="o">(</span><span class="s">&#34;/todo&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoResource</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="nc">Template</span> <span class="n">todos</span><span class="o">;</span>

    <span class="nd">@GET</span>                                                   <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">TEXT_HTML</span><span class="o">)</span>                         <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">TEXT_HTML</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">TemplateInstance</span> <span class="nf">listTodos</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">todos</span><span class="o">.</span><span class="na">data</span><span class="o">(</span><span class="s">&#34;todos&#34;</span><span class="o">,</span> <span class="nc">Todo</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">list</span><span class="o">());</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Processes HTTP GET requests for /todo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This method consumes and produces the <code>text/html</code> media type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Obtain all todos from the database and feed them to the <code>todos</code> template</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The <code>Todo</code> class is as JPA entity implemented via <a href="https://quarkus.io/guides/hibernate-orm-panache">Hibernate Panache</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Todo</span> <span class="kd">extends</span> <span class="nc">PanacheEntity</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">priority</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="n">completed</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Panache is a perfect fit for this kind of CRUD applications.
It helps with common tasks such as id mapping,
and by means of the <a href="https://en.wikipedia.org/wiki/Active_record_pattern">active record pattern</a> you get query methods like <code>findAll()</code> &#34;for free&#34;.</p>
</div>
<div class="paragraph">
<p>To produce an HTML page for displaying the result list,
the <code>todos</code> template is used.
Templates are located under <em>src/main/resources/templates</em>.
As you would expect it, changes to template files are immediatly picked up when running Quarkus in Dev Mode.
By default, the template name is derived from the field name of the injected <code>Template</code> instance,
i.e. in this case the <em>src/main/resources/templates/todos.html</em> template will be used.
It could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="code"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&#34;en&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&#34;utf-8&#34;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- CSS ... --&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href=</span><span class="s">&#34;...&#34;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;title&gt;</span>My Todos<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;container&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>My Todos<span class="nt">&lt;/h1&gt;</span>

      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&#34;table table-striped table-bordered&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">&#34;col&#34;</span> <span class="na">class=</span><span class="s">&#34;fit&#34;</span><span class="nt">&gt;</span>Id<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">&#34;col&#34;</span> <span class="nt">&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">&#34;col&#34;</span> <span class="na">class=</span><span class="s">&#34;fit&#34;</span><span class="nt">&gt;</span>Priority<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">&#34;col&#34;</span> <span class="na">class=</span><span class="s">&#34;fit&#34;</span><span class="nt">&gt;</span>Completed<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>

        {#if todos.size == 0} <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="nt">&lt;tr&gt;</span>
          <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">&#34;4&#34;</span><span class="nt">&gt;</span>No data found.<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        {#else}

        {#for todo in todos}  <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="nt">&lt;tr&gt;</span>
          <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">&#34;row&#34;</span><span class="nt">&gt;</span>#{todo.id}<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;td&gt;</span>
            {todo.title}      <i class="conum" data-value="3"></i><b>(3)</b>
          <span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;td&gt;</span>
            {todo.priority}   <i class="conum" data-value="4"></i><b>(4)</b>
          <span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;td&gt;</span> <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;custom-control custom-checkbox&#34;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&#34;checkbox&#34;</span> <span class="na">class=</span><span class="s">&#34;custom-control-input&#34;</span> <span class="na">disabled</span> <span class="na">id=</span><span class="s">&#34;completed-{todo.id}&#34;</span> <span class="err">{</span><span class="na">#if</span> <span class="na">todo.completed</span><span class="err">}</span><span class="na">checked</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&#34;custom-control-label&#34;</span> <span class="na">for=</span><span class="s">&#34;completed-{todo.id}&#34;</span><span class="nt">&gt;&lt;/label&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        {/for}
        {/if}
      <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the injected <code>todos</code> list is empty, display a placeholder row</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Otherwise, iterate over the <code>todos</code> list and add a table row for each one</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Table cell for title</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Table cell for priority</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Table cell for completion status, rendered as a checkbox</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If you’ve worked with other templating engine before, this will look very familiar to you.
You can refer to injected objects and their properties to display their values, have conditional logic, iterate over collections etc.
A very nice aspect about Qute templates is that they are processed at build time, following the Quarkus notion of &#34;compile-time boot&#34;.
This means if there is an error in a template such as unbalanced control keywords, you’ll find out about this at build time instead of only at runtime.</p>
</div>
<div class="paragraph">
<p>The <a href="https://quarkus.io/guides/qute-reference">reference documentation</a> describes the syntax and all options in depth.
Note that things are still in flux here, e.g. I couldn’t work with boolean operators in conditions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_combining_html_and_data_apis">Combining HTML and Data APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thanks to HTTP content negotiation, you can easily combine resource methods for returning HTML and JSON for API-style consumers in a single endpoint.
Just add another resource method for handling the required media type, e.g. &#34;application/json&#34;:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="nd">@GET</span>
<span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Todo</span><span class="o">&gt;</span> <span class="nf">listTodosJson</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Todo</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">list</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A standard HTTP request issued by a web browser would now be answered with the HTML page, whereas an AJAX request with the &#34;application/json&#34; accept header (or a manual invocation via <em>curl</em>) would yield the JSON representation.
I really like that idea of considering HTML and JSON-based representations as two different &#34;views&#34; of the same API essentially.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_template_organization">Template Organization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a web application has multiple pages or &#34;views&#34;, chances are there are many similarities between those.
E.g. there might be a common header and footer for all pages,
or one and the same form is used on multiple pages.</p>
</div>
<div class="paragraph">
<p>To avoid duplication in the templates in such cases, Qute supports the notion of includes.
E.g. let’s say there’s a common form for creating new and editing existing todos.
This can be put into its own template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="code"><pre><i class="conum" data-value="1"></i><b>(1)</b>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&#34;/todo/{#if update}{todo.id}/edit{#else}new{/if}&#34;</span> <span class="na">method=</span><span class="s">&#34;POST&#34;</span> <span class="na">name=</span><span class="s">&#34;todoForm&#34;</span> <span class="na">enctype=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;form-row align-items-center&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;col-sm-3 my-1&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&#34;sr-only&#34;</span> <span class="na">for=</span><span class="s">&#34;title&#34;</span><span class="nt">&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
      <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&#34;text&#34;</span> <span class="na">name=</span><span class="s">&#34;title&#34;</span> <span class="na">class=</span><span class="s">&#34;form-control&#34;</span> <span class="na">id=</span><span class="s">&#34;title&#34;</span> <span class="na">placeholder=</span><span class="s">&#34;Title&#34;</span> <span class="na">required</span> <span class="na">autofocus</span> <span class="err">{</span><span class="na">#if</span> <span class="na">update</span><span class="err">}</span><span class="na">value=</span><span class="s">&#34;{todo.title}&#34;</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;col-auto my-1&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;select</span> <span class="na">class=</span><span class="s">&#34;custom-select&#34;</span>  <span class="na">name=</span><span class="s">&#34;priority&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">disabled</span> <span class="na">value=</span><span class="s">&#34;&#34;</span><span class="nt">&gt;</span>Priority<span class="nt">&lt;/option&gt;</span>
        {#for prio in priorities}
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&#34;{prio}&#34;</span> <span class="err">{</span><span class="na">#if</span> <span class="na">todo.priority =</span><span class="s">=</span> <span class="na">prio</span><span class="err">}</span><span class="na">selected</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>{prio}<span class="nt">&lt;/option&gt;</span>
        {/for}
      <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <i class="conum" data-value="3"></i><b>(3)</b>
    {#if update}
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;col-auto my-1&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;form-check&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&#34;checkbox&#34;</span> <span class="na">name=</span><span class="s">&#34;completed&#34;</span> <span class="na">class=</span><span class="s">&#34;form-check-input&#34;</span> <span class="na">id=</span><span class="s">&#34;completed&#34;</span> <span class="err">{</span><span class="na">#if</span> <span class="na">todo.completed</span><span class="err">}</span><span class="na">checked</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&#34;form-check-label&#34;</span> <span class="na">for=</span><span class="s">&#34;completed&#34;</span><span class="nt">&gt;</span>Completed<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    {/if}

    <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&#34;submit&#34;</span> <span class="na">class=</span><span class="s">&#34;btn btn-primary&#34;</span><span class="nt">&gt;</span>{#if update}Update{#else}Create{/if}<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Post to different path for update and create</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Display existing title and priority in case of an update</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Show checkbox for completion status in case of an update</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Choose button caption depending on use case</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>In order to display this form right under the table with all todos,
the template can simply be included like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nt">&lt;h2&gt;</span>New Todo<span class="nt">&lt;/h2&gt;</span>
{#include todo-form.html}{/include}
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It’s also possible to extract the outer shell of multiple pages into a shared template (&#34;template inheritance&#34;).
This allows to extract common headers and footers into one single template with placeholders for the inner parts.</p>
</div>
<div class="paragraph">
<p>For that, create a template with the common outer structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&#34;en&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&#34;utf-8&#34;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- CSS ... --&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href=</span><span class="s">&#34;...&#34;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;title&gt;</span>{#insert title}Default Title{/}<span class="nt">&lt;/title&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;container&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>{#insert title}Default Title{/}<span class="nt">&lt;/h1&gt;</span>     <i class="conum" data-value="1"></i><b>(1)</b>

      {#insert contents}No contents!{/}            <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Derived templates define a section <code>title</code> which will be inserted here</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Derived templates define a section <code>contents</code> which will be inserted here</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Other templates can then extend the base one,
e.g. like so for the &#34;Edit Todo&#34; page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre>{#include base.html}                                <i class="conum" data-value="1"></i><b>(1)</b>
{#title}Edit Todo #{todo.id}{/title}                <i class="conum" data-value="2"></i><b>(2)</b>
{#contents}                                         <i class="conum" data-value="3"></i><b>(3)</b>
{#include todo-form.html}{/include}                 <i class="conum" data-value="4"></i><b>(4)</b>
{/contents}
{/include}
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Include the base template</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define the title section</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the contents section</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Include the template for displaying the todo form</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>As so often, a balance needs to be found between extracting common parts and still being able to comprehend the overall structure without having to pursue a large number of template references.
But in any case with includes and inserts Qute puts the neccessary tools into your hands.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_error_handling">Error Handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For a great user experience robust error handling is a must.
E.g. might happen that a user loads the &#34;Edit Todo&#34; dialog and while they’re in the process of editing, that record gets deleted by someone else.
When saving, a proper error message should be displayed to the first user.
Here’s the resource method implementation for that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="nd">@POST</span>
<span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">MULTIPART_FORM_DATA</span><span class="o">)</span>
<span class="nd">@Transactional</span>
<span class="nd">@Path</span><span class="o">(</span><span class="s">&#34;/{id}/edit&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">updateTodo</span><span class="o">(</span>
    <span class="nd">@PathParam</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">)</span> <span class="kt">long</span> <span class="n">id</span><span class="o">,</span>
    <span class="nd">@MultipartForm</span> <span class="nc">TodoForm</span> <span class="n">todoForm</span><span class="o">)</span> <span class="o">{</span>

    <span class="nc">Todo</span> <span class="n">loaded</span> <span class="o">=</span> <span class="nc">Todo</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>      <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="k">if</span> <span class="o">(</span><span class="n">loaded</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>                 <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="k">return</span> <span class="n">error</span><span class="o">.</span><span class="na">data</span><span class="o">(</span><span class="s">&#34;error&#34;</span><span class="o">,</span> <span class="s">&#34;Todo with id &#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34; has been deleted after loading this form.&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">loaded</span> <span class="o">=</span> <span class="n">todoForm</span><span class="o">.</span><span class="na">updateTodo</span><span class="o">(</span><span class="n">loaded</span><span class="o">);</span> <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="k">return</span> <span class="nc">Response</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="mi">301</span><span class="o">)</span>           <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="o">.</span><span class="na">location</span><span class="o">(</span><span class="no">URI</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">&#34;/todo&#34;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Load the todo record to be updated</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If it doesn’t exist, render the &#34;error&#34; template</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Otherwise, update the record; as <code>loaded</code> is an attached entity, no call to persist is needed</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>redirect the user to the main page, avoiding issues with reloading etc. (<a href="https://en.wikipedia.org/wiki/Post/Redirect/Get">post-redirect-get</a> pattern)</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Note that <code>TemplateInstance</code> as returned from the <code>Template#data()</code> method doesn’t extend the JAX-RS <code>Response</code> class.
Therefore the return type of the method must be declared as <code>Object</code> in this case.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_search">Search</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thanks to Hibernate Panache it’s quite simple to refine the todo list and only return those whose title matches a given search term.
Also ordering the list in some meaningful way would be nice.
All we need is an optional query parameter for specifying the search term and a custom query method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre><span class="nd">@GET</span>
<span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">TEXT_HTML</span><span class="o">)</span>
<span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">TEXT_HTML</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">TemplateInstance</span> <span class="nf">listTodos</span><span class="o">(</span><span class="nd">@QueryParam</span><span class="o">(</span><span class="s">&#34;filter&#34;</span><span class="o">)</span> <span class="nc">String</span> <span class="n">filter</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">todos</span><span class="o">.</span><span class="na">data</span><span class="o">(</span><span class="s">&#34;todos&#34;</span><span class="o">,</span> <span class="n">find</span><span class="o">(</span><span class="n">filter</span><span class="o">));</span>
<span class="o">}</span>

<span class="nd">@GET</span>
<span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Todo</span><span class="o">&gt;</span> <span class="nf">listTodosJson</span><span class="o">(</span><span class="nd">@QueryParam</span><span class="o">(</span><span class="s">&#34;filter&#34;</span><span class="o">)</span> <span class="nc">String</span> <span class="n">filter</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">find</span><span class="o">(</span><span class="n">filter</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Todo</span><span class="o">&gt;</span> <span class="nf">find</span><span class="o">(</span><span class="nc">String</span> <span class="n">filter</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Sort</span> <span class="n">sort</span> <span class="o">=</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">ascending</span><span class="o">(</span><span class="s">&#34;completed&#34;</span><span class="o">)</span>    <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="s">&#34;priority&#34;</span><span class="o">,</span> <span class="nc">Direction</span><span class="o">.</span><span class="na">Descending</span><span class="o">)</span>
        <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">,</span> <span class="nc">Direction</span><span class="o">.</span><span class="na">Ascending</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">filter</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">filter</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="k">return</span> <span class="nc">Todo</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="s">&#34;LOWER(title) LIKE LOWER(?1)&#34;</span><span class="o">,</span> <span class="n">sort</span><span class="o">,</span> <span class="s">&#34;%&#34;</span> <span class="o">+</span> <span class="n">filter</span> <span class="o">+</span> <span class="s">&#34;%&#34;</span><span class="o">).</span><span class="na">list</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Todo</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">sort</span><span class="o">).</span><span class="na">list</span><span class="o">();</span>      <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>First sort by completion status, then priority, then by title</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If a filter is given, apply the search term lower-cased and with wildcards, i.e. using a <code>WHERE</code> clause such as <code>where lower(todo0_.title) like lower(%searchterm%)</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Otherwise, return all todos</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>To enter the search term, a form is added next to the table of todos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
</pre></td><td class="code"><pre><i class="conum" data-value="1"></i><b>(1)</b>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&#34;/todo&#34;</span> <span class="na">method=</span><span class="s">&#34;GET&#34;</span> <span class="na">name=</span><span class="s">&#34;search&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;form-row align-items-center&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;col-sm-3 my-1&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&#34;sr-only&#34;</span> <span class="na">for=</span><span class="s">&#34;filter&#34;</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/label&gt;</span>
      <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&#34;text&#34;</span> <span class="na">name=</span><span class="s">&#34;filter&#34;</span> <span class="na">class=</span><span class="s">&#34;form-control&#34;</span> <span class="na">id=</span><span class="s">&#34;filter&#34;</span> <span class="na">placeholder=</span><span class="s">&#34;Search By Title&#34;</span> <span class="na">required</span> <span class="err">{</span><span class="na">#if</span> <span class="na">filtered</span><span class="err">}</span><span class="na">value=</span><span class="s">&#34;{filter}&#34;</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&#34;btn btn-primary&#34;</span> <span class="na">value=</span><span class="s">&#34;Search&#34;</span> <span class="na">type=</span><span class="s">&#34;submit&#34;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&#34;btn btn-secondary {#if !filtered}disabled{/if}&#34;</span> <span class="na">href=</span><span class="s">&#34;/todo&#34;</span> <span class="na">role=</span><span class="s">&#34;button&#34;</span><span class="nt">&gt;</span>Clear Filter<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Invoke this page with the entered search as query parameter</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Input for the search term; show the previously entered term, if any</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A button for clearing the result list if a search term has been entered; otherwise the button will be disabled</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_smoother_user_experience_via_unpoly">Smoother User Experience via Unpoly</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The last thing I wanted to explore is how the usability and performance of the application can be improved by means of some client-side enhancements.
By default, a web app rendered on the server-side like ours requires full page loads when going from one page to the other.
This is where single page applications (SPAs) implemented with client-side frameworks shine:
just parts of the document object model tree in the browser will be replaced e.g. when loading a result list via AJAX,
resulting in a much smoother and faster user experience.</p>
</div>
<div class="paragraph">
<p>Does this mean we have to give up on server-side rendering altogether if we’re after this kind of UX?
Luckily not, as small helper libraries such as <a href="https://unpoly.com/">Unpoly</a>, <a href="https://intercoolerjs.org/">Intercooler</a> or <a href="https://github.com/turbolinks/turbolinks">Turbolinks</a> can be leveraged to replace just page fragments instead of requiring full page loads.
This results in a smooth SPA-like user experience without having to opt into the full client-side programming model.
For the Todo example I’ve obtained great results using Unpoly.
After importing its JavaScript file, all that’s needed is to add the <code>up-target</code> attribute to links or forms.</p>
</div>
<div class="paragraph">
<p>E.g. here’s the form for entering the search term with that modification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
</pre></td><td class="code"><pre><i class="conum" data-value="1"></i><b>(1)</b>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&#34;/todo&#34;</span> <span class="na">method=</span><span class="s">&#34;GET&#34;</span> <span class="na">name=</span><span class="s">&#34;search&#34;</span> <span class="na">up-target=</span><span class="s">&#34;.container&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;form-row align-items-center&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#34;col-sm-3 my-1&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&#34;sr-only&#34;</span> <span class="na">for=</span><span class="s">&#34;filter&#34;</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&#34;text&#34;</span> <span class="na">name=</span><span class="s">&#34;filter&#34;</span> <span class="na">class=</span><span class="s">&#34;form-control&#34;</span> <span class="na">id=</span><span class="s">&#34;filter&#34;</span> <span class="na">placeholder=</span><span class="s">&#34;Search By Title&#34;</span> <span class="na">required</span> <span class="err">{</span><span class="na">#if</span> <span class="na">filtered</span><span class="err">}</span><span class="na">value=</span><span class="s">&#34;{filter}&#34;</span><span class="err">{/</span><span class="na">if</span><span class="err">}</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&#34;btn btn-primary&#34;</span> <span class="na">value=</span><span class="s">&#34;Search&#34;</span> <span class="na">type=</span><span class="s">&#34;submit&#34;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span>

    <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&#34;btn btn-secondary {#if !filtered}disabled{/if}&#34;</span> <span class="na">href=</span><span class="s">&#34;/todo&#34;</span> <span class="na">role=</span><span class="s">&#34;button&#34;</span> <span class="na">up-target=</span><span class="s">&#34;.container&#34;</span><span class="nt">&gt;</span>Clear Filter<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When receiving the result of the form submission, replace the <code>&lt;div&gt;</code> with CSS class <code>container</code> of the current page with the one from the response</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Do the same when following the &#34;Clear Filter&#34; link</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The magic trick of Unpoly is that links and forms with the <code>up-target</code> attribute are intercepted by Unpoly and executed via AJAX calls.
The specified fragments from the result page are then used to replace parts of the already loaded page, instead of having the browser load the full response page.
The result is the fast user experience shown in the video above.</p>
</div>
<div class="paragraph">
<p>Unpoly also allows to show page fragments in modal dialogs,
allowing to remain on the same page also when showing forms such as the one for editing a todo:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/qute_modal.png" alt="qute modal"/>
</div>
</div>
<div class="paragraph">
<p>Note that if JavaScript is disabled, the application gracefully falls back to full page loads. I.e. it will still be fully functional, just with a slightly degraded user experience.
The same would happen when accessing the edit dialog directly via its URL or when opening the &#34;Edit&#34; link in a new tab or window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/qute_tab.png" alt="qute tab"/>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bonus_using_webjars">Bonus: Using WebJars</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a thread on Twitter James Ward <a href="https://twitter.com/_JamesWard/status/1213148846324367360">brought up</a> the idea of pulling in required resources such as Bootstrap via WebJars instead of getting them from a CDN.
<a href="https://www.webjars.org/">WebJars</a> is a useful utility for obtaining all sorts of client-side libraries with Java build tools such as Maven or Gradle.</p>
</div>
<div class="paragraph">
<p>For Bootstrap, the following dependency must be added to the Maven <em>pom.xml</em> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>bootstrap<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.4.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Bootstrap CSS can then be included within the <em>base.html</em> template like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="html"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre>...
<span class="nt">&lt;head&gt;</span>
  ...
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href=</span><span class="s">&#34;/webjars/bootstrap/4.4.1/css/bootstrap.min.css&#34;</span><span class="nt">&gt;</span>
  ...
<span class="nt">&lt;/head&gt;</span>
...
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is all that’s needed in order to use Bootstrap via WebJars.
Note this will work on the JVM and also with a native binary via <a href="https://www.graalvm.org/">GraalVM</a>:
WebJars resources are located under <em>META-INF/resources</em>, and Quarkus <a href="https://quarkus.io/guides/writing-native-applications-tips#including-resources">automatically adds</a> all resources from there when building a native image.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wrap_up">Wrap Up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This concludes my quick tour through server-side web applications with Quarkus and its new Qute extension.
Where only web applications based on REST APIs called by client-side web applications were supported before, Qute is a great addition to the list of Quarkus extensions, allowing to choose different architecture styles based on your needs and preferences.</p>
</div>
<div class="paragraph">
<p>Note that Qute currently is in &#34;Experimental&#34; state, i.e. it’s a great time to give it a try and share your feedback, but be prepared for possible immaturities and potential changes down the road.
E.g. I noticed that complex boolean expressions in template conditions <a href="https://github.com/quarkusio/quarkus/issues/6369">aren’t support yet</a>.
Also it would be great to get build-time feedback upon <a href="https://github.com/quarkusio/quarkus/issues/6391">invalid variable references</a> in templates.</p>
</div>
<div class="paragraph">
<p>To learn more, refer to the Qute <a href="https://quarkus.io/guides/qute">guide</a> and its <a href="https://quarkus.io/guides/qute-reference">reference documentation</a>.
You can find the complete source code of the Todo example including instructions for building and running in this <a href="https://github.com/gunnarmorling/quarkus-qute">GitHub repo</a>.</p>
</div>
</div>
</div>
			</div>

			<div class="post-tags">
				
					
				
			</div>
		</div><div id="disqus_thread">
  <script src="https://giscus.app/client.js"
    data-repo="gunnarmorling/discussions.morling.dev"
    data-repo-id="R_kgDOGXzqNQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOGXzqNc4B_2Pq"
    data-mapping="title"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
</div>

<noscript>Please enable JavaScript, or join the <a href="https://github.com/gunnarmorling/discussions.morling.dev/discussions/">discussion on GitHub</a>.</noscript>
</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> © 2019 - 2024 Gunnar Morling |  Licensed Under <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons BY-SA 4.0</a></div>
	</nav>
</div><script>
	mediumZoom(document.querySelectorAll('div.imageblock > div.content > img'))
</script>

</body>
</html>
