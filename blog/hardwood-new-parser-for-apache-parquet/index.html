<!DOCTYPE html>
<html>
<head>
	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-DD997656SV"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-DD997656SV');
	</script>

	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Hardwood: A New Parser for Apache Parquet - Gunnar Morling</title>
	<link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" />
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" />
	<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
	<link rel="shortcut icon" href="/favicon/favicon.ico" />

	<meta name="viewport" content="width=device-width, initial-scale=1">

	
	<link rel="preload" href="/fonts/raleway-v37-latin-200.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/raleway-v37-latin-300.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/raleway-v37-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

	<link rel="preload" href="/fonts/lato-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lato-latin-400-italic.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lato-latin-700-normal.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lato-latin-700-italic.woff2" as="font" type="font/woff2" crossorigin>

	<link rel="preload" href="/fonts/lora-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lora-latin-400-italic.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lora-latin-700-normal.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/lora-latin-700-italic.woff2" as="font" type="font/woff2" crossorigin><meta property="og:url" content="https://www.morling.dev/blog/hardwood-new-parser-for-apache-parquet/">
  <meta property="og:site_name" content="Gunnar Morling">
  <meta property="og:title" content="Hardwood: A New Parser for Apache Parquet">
  <meta property="og:description" content=" Today, it’s my great pleasure to announce the first public release of Hardwood, a new parser for the Apache Parquet file format, optimized for minimal dependencies and great performance.
Hardwood is …">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="blog">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2026-02-26T14:30:00&#43;02:00">
    <meta property="article:modified_time" content="2026-02-26T14:30:00&#43;02:00">
<meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hardwood: A New Parser for Apache Parquet">
  <meta name="twitter:description" content=" Today, it’s my great pleasure to announce the first public release of Hardwood, a new parser for the Apache Parquet file format, optimized for minimal dependencies and great performance.
Hardwood is …">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.min.efd5060e5dbdbc4655a896b01b99c2b759dc5710f5cfda5ed34c2259de325469.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/main.min.7e747dab5a47b967474cfdc64085734aa21b459c2bc3519033238d0258bb7dcc.css" />

	
	<link rel="stylesheet" type="text/css" href="/css/base16.dark.min.c40398d5ec04ac387c57141dc29e820fc4012da1cf2af8235004fc9945fa76a8.css" />
	
	<link rel="stylesheet" type="text/css" href="/css/morlingdev.min.20888cb6b76ed17eb07628f659718d130e32ea466294927dc4dfb410a3e3f3ab.css" />
	

	<script>
		const searchUrl = "https:\/\/search-morling-dev.onrender.com\/";
		const apiKey = "ff90d45f4afad3bd914c";
	</script>
	<script src="/js/main.min.9ee619eea7f51473f4284ef86c76bdb1b0089e19781ca97275924edf53be5bd4.js"></script>
	<script src="https://www.morling.dev//js/medium-zoom.min.js"></script>

	<noscript>
		<style type="text/css">
			.club { display:none; }
		</style>
	</noscript>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<div class="header-image-container">
		<img class="header-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
	</div>
	<div class="header-title">
		<h1 class="site-title"><a href="https://www.morling.dev/">Gunnar Morling</a></h1>
		<div class="site-description"><h2>Random Musings on All Things Software Engineering</h2></div>
	</div>
	<div class="header-nav-wrapper">
		<nav class="row pre-nav">
			<div class="pull-right">
				<ul class="flat"><li>
						<a href="/blog/index.xml" title="RSS FEED">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#rss"/>
							</svg>
						</a>
					</li><li>
						<a href="https://github.com/gunnarmorling" title="GitHub">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#github"/>
							</svg>
						</a>
					</li><li>
						<a href="https://bsky.app/profile/gunnarmorling.dev" title="Bluesky">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#cloud"/>
							</svg>
						</a>
					</li><li>
						<a href="https://twitter.com/gunnarmorling" title="Twitter">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#twitter"/>
							</svg>
						</a>
					</li><li>
						<a href="https://www.linkedin.com/in/gunnar-morling/" title="LinkedIn">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#linkedin"/>
							</svg>
						</a>
					</li><li>
						<a href="https://mastodon.online/@gunnarmorling" title="Mastodon">
							<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<use xlink:href="/svg/feather-sprite.svg#message-square"/>
							</svg>
						</a>
					</li></ul>
			</div>
		</nav>
		<nav class="row nav">
			<div>
				<ul class="flat">
					
					<li>
						<a href="/blog">Blog</a>
					</li>
					
					<li>
						<a href="/projects/">Projects</a>
					</li>
					
					<li>
						<a href="/conferences/">Conferences</a>
					</li>
					
					<li>
						<a href="/podcasts/">Podcasts</a>
					</li>
					
					<li>
						<a href="/about/">About</a>
					</li>
					
				</ul>
			</div>
			<div class="pull-right">
				<div class="club">
					<form id="myForm">
						<input type="text" id="inputSearch" name="q" placeholder="Search..." onfocus="warmUp(this)">
						<button type="submit" id="buttonSubmitSearch" style="line-height: normal;"><i id="iconSearch" class="fa fa-search"></i></button>
					</form>
				</div>
			</div>
		</nav>
	</div>
</div>

<script type="text/javascript">
	window.addEventListener( "load", function () {
		const form = document.getElementById( "myForm" );

		form.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(form));
		});
	});
</script>


		<div id = "main-content">
			<div class="post-header">
				<h1 class="title">Hardwood: A New Parser for Apache Parquet</h1>
				<div class="post-meta-line">
					<span class="meta">Posted at Feb 26, 2026</span>
					
					<span class="post-tags-inline">
						
						<a href="/tags/parquet">parquet</a>
						
						<a href="/tags/open-source">open-source</a>
						
						<a href="/tags/java">java</a>
						
						<a href="/tags/performance">performance</a>
						
					</span>
					
				</div>
			</div>

			<div class="post-content">
				<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_why_hardwood">Why Hardwood?</a></li>
<li><a href="#_hello_hardwood">Hello, Hardwood!</a></li>
<li><a href="#_parsing_performance">Parsing Performance</a></li>
<li><a href="#_built_with_ai_not_by_ai">Built With AI, Not By AI</a></li>
<li><a href="#_whats_next">What’s Next?</a></li>
</ul>
</div>
<div class="paragraph">
<p>Today, it’s my great pleasure to announce the first public release of Hardwood, a new parser for the Apache Parquet file format, optimized for minimal dependencies and great performance.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/hardwood-hq/hardwood">Hardwood</a> is open-source (Apache License 2.0) and supports Java 21 or newer. You can grab it from <a href="https://central.sonatype.com/search?q=hardwood&amp;namespace=dev.hardwood">Maven Central</a> and start parsing your Parquet files with ease and efficiency.</p>
</div>
<div class="sect1">
<h2 id="_why_hardwood">Why Hardwood?<a class="anchor" href="#_why_hardwood"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://parquet.apache.org/">Apache Parquet</a> has become the lingua franca of the modern data ecosystem. With its columnar data layout, Parquet enables efficient analytical queries and significant compression. This makes it a highly popular storage format for data lakes, supported by table formats such as Apache Iceberg and Delta Lake, as well as query engines like Trino and DuckDB. Whether you’re building ETL pipelines, running ad-hoc analytics, or training ML models, chances are Parquet files are somewhere in the mix.</p>
</div>
<div class="paragraph">
<p>Parquet support exists across a wide range of languages and runtimes. For Java, the <a href="https://github.com/apache/parquet-java">parquet-java</a> project is the most widely used library for parsing (and writing) Parquet files. Unfortunately, parquet-java is very dependency-heavy—most notably, pulling in Hadoop, amongst other things—and its reader is single-threaded, not taking advantage of all the cores your system may have.</p>
</div>
<div class="paragraph">
<p>This is where Hardwood comes in: it is a brand-new Parquet parser implementation written from the ground up in modern Java, based on the Parquet specification and test files. It avoids external dependencies as much as possible, the only exception being (optional) libraries for compression algorithms found in Parquet files, such as snappy or zstd. Another key objective for Hardwood is achieving great performance: a multi-threaded decoding pipeline distributes the work of parsing Parquet files across all the available CPU cores, yielding significantly faster parsing times.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hello_hardwood">Hello, Hardwood!<a class="anchor" href="#_hello_hardwood"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let’s take a quick look at how to use Hardwood for parsing a Parquet file. To get started, add Hardwood as a project dependency, e.g. like so for Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>dev.hardwood<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hardwood-core<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.0.0.Alpha1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Hardwood doesn’t pull in any transitive dependencies. If you want to parse Parquet files using one of the supported compression algorithms, add the library for that, too (one of snappy-java, zstd-jni, lz4-java, or brotli4j). For instance, add the following for snappy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.xerial.snappy<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>snappy-java<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.1.10.8<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Hardwood provides two APIs for accessing the contents of Parquet files, a row-oriented API and a columnar API. The first one, <code>RowReader</code>, comes in handy in particular when working with complex, nested record schemas, making it very easy to access the contents of nested structs, lists, etc.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="code"><pre><span class="nc">Path</span> <span class="n">myParquetFile</span> <span class="o">=</span> <span class="o">...;</span>
<span class="k">try</span> <span class="o">(</span><span class="nc">ParquetFileReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="nc">ParquetFileReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">myParquetFile</span><span class="o">);</span>
  <span class="nc">RowReader</span> <span class="n">rowReader</span> <span class="o">=</span> <span class="n">fileReader</span><span class="o">.</span><span class="na">createRowReader</span><span class="o">())</span> <span class="o">{</span>

  <span class="k">while</span> <span class="o">(</span><span class="n">rowReader</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">rowReader</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>

    <span class="c1">// Access columns with typed accessors by name...</span>
    <span class="kt">long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">);</span>

    <span class="c1">// ... Or by index</span>
    <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">);</span>

    <span class="c1">// Logical types are automatically converted</span>
    <span class="nc">LocalDate</span> <span class="n">birthDate</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="s">&#34;birth_date&#34;</span><span class="o">);</span>
    <span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getUuid</span><span class="o">(</span><span class="s">&#34;account_id&#34;</span><span class="o">);</span>

    <span class="c1">// Check for null values</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">rowReader</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">))</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">&#34;age&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Access nested structs</span>
    <span class="nc">PqStruct</span> <span class="n">address</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getStruct</span><span class="o">(</span><span class="s">&#34;address&#34;</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">address</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">city</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;city&#34;</span><span class="o">);</span>
      <span class="kt">int</span> <span class="n">zip</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">&#34;zip&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Access lists and iterate with typed accessors</span>
    <span class="nc">PqList</span> <span class="n">tags</span> <span class="o">=</span> <span class="n">rowReader</span><span class="o">.</span><span class="na">getList</span><span class="o">(</span><span class="s">&#34;tags&#34;</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">tags</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">tag</span> <span class="o">:</span> <span class="n">tags</span><span class="o">.</span><span class="na">strings</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">//...</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In contrast, the <code>ColumnReader</code> API is a bit more low-level, providing direct access to the column values of a Parquet file. It is the preferred choice when peak performance is the primary concern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="k">try</span> <span class="o">(</span><span class="nc">ParquetFileReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="nc">ParquetFileReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">myParquetFile</span><span class="o">))</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">(</span><span class="nc">ColumnReader</span> <span class="n">fare</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">createColumnReader</span><span class="o">(</span><span class="s">&#34;fare_amount&#34;</span><span class="o">))</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">fare</span><span class="o">.</span><span class="na">nextBatch</span><span class="o">())</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">fare</span><span class="o">.</span><span class="na">getValueCount</span><span class="o">();</span>
      <span class="kt">double</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">fare</span><span class="o">.</span><span class="na">getDoubles</span><span class="o">();</span>

      <span class="c1">// null if column is required</span>
      <span class="nc">BitSet</span> <span class="n">nulls</span> <span class="o">=</span> <span class="n">fare</span><span class="o">.</span><span class="na">getElementNulls</span><span class="o">();</span>

      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">nulls</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">nulls</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
          <span class="n">sum</span> <span class="o">+=</span> <span class="n">values</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The columnar API is less convenient to use, in particular when it comes to reading files with nested or repeatable schemas. However, it can yield significantly higher throughput than the row reader API. It returns batches in the form of typed primitive arrays (e.g., <code>double[]</code>) that can be iterated with a simple for loop, avoiding the per-row <code>next()</code>/<code>getDouble()</code> method calls, virtual dispatch, and null-checking overhead of the row reader. It also enables the JIT compiler to auto-vectorize tight loops over contiguous arrays and improves CPU cache utilization by accessing a single column’s data sequentially rather than interleaving across all columns.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_parsing_performance">Parsing Performance<a class="anchor" href="#_parsing_performance"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hardwood is built with high performance in mind. It applies many of the lessons learned from <a href="https://github.com/gunnarmorling/1brc">1BRC</a>, such as memory-mapping files or multi-threading. I am planning to share more details in a future blog post, so I’m going to focus just on one specific performance-related aspect here: Parallelizing the work of parsing Parquet files, so as to utilize the available CPU resources as much as possible and achieve high throughput.</p>
</div>
<div class="paragraph">
<p>This task is <a href="https://www.linkedin.com/posts/gunnar-morling_hardwood-activity-7421540936763129856-FCwD">surprisingly complex</a> due to the subtleties of the format, so Hardwood pulls a few tricks for taking advantage of all the available cores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Page-level parallelism</strong>, fanning out the work of decoding individual data pages to multiple worker threads. This allows for a much higher CPU utilization (and lower memory consumption) than when solely processing different column chunks, row groups, or even files in parallel.</p>
</li>
<li>
<p><strong>Adaptive page prefetching</strong>, ensuring that columns which are slower to decode than others (e.g. depending on their data type) receive more resources, so that all columns of a file can be read at the same pace.</p>
</li>
<li>
<p><strong>Cross-file prefetching</strong>, starting to map and decode the pages of file N+1 when approaching the end of file N of a multi-file dataset, avoiding any slowdown at file transitions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By employing these techniques and some others, such as minimizing allocations and avoiding auto-boxing of primitive values, Hardwood’s performance has come quite a long way since starting the project at the end of last year. As an example, the values of three out of 20 columns of the <a href="https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page">NYC taxi ride data set</a> (a subset of 119 files overall, ~9.2 GB total, ~650M rows) can be summed up in ~2.7 sec using the row reader API with indexed access on my MacBook Pro M3 Max with 16 CPU cores. With the column reader API, the same task takes ~1.2 sec.</p>
</div>
<div class="paragraph">
<p>The taxi ride data set has a completely flat schema, i.e. it doesn’t contain any structs, lists, or maps. Most Parquet-based data sets fall into this category, and thus the focus for optimizing Hardwood has primarily been on these kinds of files so far. While less commonly found, the Parquet format also supports nested schemas. An example for this category are the Parquet files of the <a href="https://docs.overturemaps.org/getting-data/">Overture Maps</a> project. On the same machine as above, Hardwood can completely parse all the columns of a file with points of interest (~900 MB, ~9M records) in ~2.1 sec using the row reader API and in ~1.3 sec with the column reader API.</p>
</div>
<div class="paragraph">
<p>In order to identify bottlenecks, Hardwood comes with support for the JDK Flight Recorder, tracking key performance metrics and events such as prefetch misses, page decoding times, etc.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/hardwood_jfr.png" alt="Hardwood JFR Events in JDK Mission Control"/>
</div>
</div>
<div class="paragraph">
<p>Further improving performance remains a key objective for the project going forward; to that end there are some first automated performance tests for flat and nested schemas and we are planning to set up an automated change detection pipeline using <a href="https://otava.apache.org/">Apache Otava</a>, allowing us to detect any potential regressions early on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_with_ai_not_by_ai">Built With AI, Not By AI<a class="anchor" href="#_built_with_ai_not_by_ai"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>AI is used extensively for building Hardwood. Getting first-hand experience of how capable current LLMs are when building a relatively low-level code base like a file parser has been one of the motivations for starting the project.</p>
</div>
<div class="paragraph">
<p>Claude Code is the tool of choice, and overall the experience has been really good. It would have been impossible to make progress as quickly without it. The task lends itself well to LLM-assisted coding: there is a <a href="https://github.com/apache/parquet-format">comprehensive specification</a> and an extensive <a href="https://github.com/apache/parquet-testing">suite of test files</a> to assert correctness against. Adding support for another encoding or compression algorithm, analyzing failing tests, fixing thread pool starvation bugs—Claude handles these tasks very effectively.</p>
</div>
<div class="paragraph">
<p>So, are we using AI for building Hardwood? Absolutely. Is Hardwood vibe-coded? Absolutely not.</p>
</div>
<div class="paragraph">
<p>The LLM-generated code is a starting point, not an end state. Claude will happily duplicate logic, paper over corner cases with yet another if/else, or quietly <a href="https://www.linkedin.com/posts/gunnar-morling_claude-code-happily-excluding-an-incorrect-activity-7431793474833780737-RtV3">exclude an unexpected result from a test</a>, instead of fixing the underlying bug. You need to examine the code, understand it, and take ownership of it. &#34;But Claude did this&#34; is not going to cut it when things go wrong.</p>
</div>
<div class="paragraph">
<p>As things stand, AI is an amazing tool and an incredible productivity booster, but one you need to use with intention and deep understanding. And I don’t think it’s going to make libraries like Hardwood obsolete any time soon. Could you vibe-code something which parses a given file? Maybe. But building a solution that is correct, fast, and maintainable still takes significant effort, and there’s no point in reinventing the wheel over and over again.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_next">What’s Next?<a class="anchor" href="#_whats_next"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>So, what’s next for Hardwood then? Really, we’re just at the beginning. I’d love for folks to take the 1.0.0.Alpha1 release for a spin and parse some of their Parquet files. Any bug reports or feature requests are welcome in the <a href="https://github.com/hardwood-hq/hardwood/issues">issue tracker</a>.</p>
</div>
<div class="paragraph">
<p>As of this release, Hardwood supports all Parquet column types, column projections, as well as all key encoding and compression types. So it will work very well for use cases processing all the values of a file or certain columns.</p>
</div>
<div class="paragraph">
<p>While the parser is relatively complete overall, one key part still missing is support for predicate push-down. The Parquet format supports different ways for pruning entire row groups from processing, including column statistics and Bloom filters. <a href="https://github.com/hardwood-hq/hardwood/issues/59">This is on the roadmap</a> for one of the next 1.0 preview releases, at which point Hardwood will also be a good fit for use cases with higher data selectivity, e.g. allowing to <a href="https://github.com/hardwood-hq/hardwood/issues/31">fetch only relevant segments</a> of a file from remote object storage. We are also working on a <a href="https://github.com/hardwood-hq/hardwood/issues/62">parquet-java compatibility layer</a>, implementing its key APIs on top of Hardwood, to simplify migrations from one project to the other.</p>
</div>
<div class="paragraph">
<p>For the time after the 1.0 final release, we are planning to add support for writing Parquet files, and we may provide a CLI tool for inspecting and analyzing Parquet files. In the long term, the project could evolve into a library and toolkit for working with Parquet-based data lake table formats such as Apache Iceberg, it could serve as a testing bed for alternative columnar file formats, and much more.</p>
</div>
<div class="paragraph">
<p>Lastly, I’d like to give a massive shout-out to <a href="https://linkedin.com/in/aalmiray/">Andres Almiray</a> (release automation) and <a href="https://linkedin.com/in/rionw/">Rion Williams</a> (performance optimizations, JFR support) for their contributions to the project and this release!</p>
</div>
<div class="paragraph">
<p>Onwards and upwards!</p>
</div>
</div>
</div>
			</div>

			
			
			
			<div class="related-posts">
				<h3>Read Next</h3>
				<ul>
					
					<li><a href="/blog/lower-java-tail-latencies-with-zgc/">Let&#39;s Take a Look at... Lower Java Tail Latencies With ZGC</a> <span class="meta">Sep 17, 2025</span></li>
					
					<li><a href="/blog/jep-483-aot-class-loading-linking/">Let&#39;s Take a Look at... JEP 483: Ahead-of-Time Class Loading &amp; Linking!</a> <span class="meta">Mar 27, 2025</span></li>
					
					<li><a href="/blog/1brc-results-are-in/">1BRC—The Results Are In!</a> <span class="meta">Feb 4, 2024</span></li>
					
				</ul>
			</div>
			
			
		</div>

		<div class="post-footer">
			<div style="display: flex; align-items: center; gap: 1rem;">
				<div class="header-image-container" style="flex-shrink: 0;">
					<img class="footer-image" src="/images/gunnar_morling.jpg" alt="Gunnar Morling">
				</div>
				<p style="margin: 0;">Gunnar Morling is an open-source software engineer in the Java and data streaming space. He currently works as a Technologist for Confluent. In his past role at Decodable he focused on developer outreach and helped them build their stream processing platform based on Apache Flink. Prior to that, he spent ten years at Red Hat, where he led the Debezium project, a platform for change data capture.</p>
			</div>
		</div>

		
		
		<div class="post-discussions">
			<p>Comment below, or join the discussion on
			<a href="https://hn.algolia.com/?query=morling.dev/blog/hardwood-new-parser-for-apache-parquet/">Hacker News</a>,
			<a href="https://lobste.rs/search?q=domain:morling.dev+title:%22Hardwood%3a%20A%20New%20Parser%20for%20Apache%20Parquet%22&what=stories">Lobsters</a>, and
			<a href="https://www.reddit.com/search/?q=url:morling.dev/blog/hardwood-new-parser-for-apache-parquet/">Reddit</a>.
			</p>
		</div>
		<div id="disqus_thread"></div>

<script>
  
  window.addEventListener('load', function() {
    
    setTimeout(function() {
      const commentsContainer = document.getElementById('disqus_thread');
      const script = document.createElement('script');
      script.src = 'https://giscus.app/client.js';
      script.setAttribute('data-repo', 'gunnarmorling/discussions.morling.dev');
      script.setAttribute('data-repo-id', 'R_kgDOGXzqNQ');
      script.setAttribute('data-category', 'Announcements');
      script.setAttribute('data-category-id', 'DIC_kwDOGXzqNc4B_2Pq');
      script.setAttribute('data-mapping', 'title');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata', '0');
      script.setAttribute('data-theme', 'light');
      script.setAttribute('data-lang', 'en');
      script.setAttribute('crossorigin', 'anonymous');
      script.async = true;
      commentsContainer.appendChild(script);
    }, 100);
  });
</script>

<noscript>Please enable JavaScript, or join the <a href="https://github.com/gunnarmorling/discussions.morling.dev/discussions/">discussion on GitHub</a>.</noscript>
</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> © 2019 - 2026 Gunnar Morling |  Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons BY-SA 4.0</a> | <a href="/ai">How I use (and don't use) AI</a></div>
	</nav>
</div><script>
	mediumZoom(document.querySelectorAll('div.imageblock > div.content > img'))
</script>

</body>
</html>
